
<!DOCTYPE HTML>

<html>
	<meta charset="utf-8">
  <head>
		<title>Sequence Viewer</title>
	  <script>
		  var locSplit = window.location.toString().split(/[\/]+/);
			var rName = locSplit[2];
			var jsLibsScript = document.createElement("script")
			jsLibsScript.type = "text/javascript";
			jsLibsScript.src = "/" + rName + "/jsLibs";
			document.getElementsByTagName("head")[0].appendChild(jsLibsScript);
			var jsOwnScript = document.createElement("script")
			jsOwnScript.type = "text/javascript";
			jsOwnScript.src = "/" + rName + "/jsOwn";
			document.getElementsByTagName("head")[0].appendChild(jsOwnScript);
			var cssLibsLink = document.createElement("link")
			cssLibsLink.type = "text/css";
			cssLibsLink.href = "/" + rName + "/cssLibs";
			cssLibsLink.rel = "stylesheet"
			document.getElementsByTagName("head")[0].appendChild(cssLibsLink);
			var cssOwnLink = document.createElement("link")
			cssOwnLink.type = "text/css";
			cssOwnLink.href = "/" + rName + "/cssOwn";
			cssOwnLink.rel = "stylesheet"
			document.getElementsByTagName("head")[0].appendChild(cssOwnLink);
	  </script>
  </head>
  <body>

	
    <script>
    	$(document).ready(function(){
			var locSplit = window.location.toString().split(/[\/]+/);
			var rName = locSplit[2];
			addDiv("body", "viewer");
			
			var gifLoading = prsentDivGifLoading();
			var cellWidth = 20;
			var cellHeight = 25;
		  makeRequest({
		  		url: '/' + rName + '/seqData',
		  		method: "GET"
		  	}).then(function (datums) {
		  		var mainData = JSON.parse(datums);
					console.log(mainData);
					var SeqViewer = new njhSeqView("#viewer",  mainData, cellWidth, cellHeight, mainData["baseColor"], false, "protein" == mainData["seqType"], mainData["sessionUID"]);

					gifLoading.remove()
					
					initSeqViewer(SeqViewer);
					$(window).on('beforeunload', function(){
					  	makeRequest({
					  		url: '/' + rName + '/closeSession',
					  		method: "POST",
					  		params: {"sessionUID" : mainData["sessionUID"]},
					  		headers: {"Content-Type" : "application/json"}
					  	}).then(function (datums) {
					  		console.log(JSON.parse(datums));
					  	}).catch(logRequestError);
					});
		  	}).catch(logRequestError);
		  /*
		  document.addEventListener('copy', function(e){
			  console.log(e); 
			    e.clipboardData.setData('text/plain', 'Hello, world!');
			    e.clipboardData.setData('text/html', '<b>Hello, world!</b>');
			    e.preventDefault(); // We want our data, not data from any selection, to be written to the clipboard
			});*/
			
			/*
			$(window).on('beforeunload', function(){
			      return 'Are you sure you want to leave?';
			});*/
			
		});
		
    </script> 
  </body>
</html>
